<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Using the Dynamic API from an External Interface</title>
    <link rel="StyleSheet" href="css/Chapter%207.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <div>
      <img src="snt-logo-text2-transparent-small.png" />
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="Chapter%207.18.1.html#939876">7	Dynamic API</a> &gt; 7.2  Using the Dynamic API from an External Interface</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading1Numbered">7.2  <a name="939876">Using the Dynamic API from an External Interface</a></div>
      <div class="BodyAfterHead"><a name="939878">An external interface may access the dynamic hierarchy through the partition structure. An external interface uses the dynamic API through the following functions of the </a><span style="font-family: &quot;Courier New&quot;">D_Hierarchy</span> class, which is defined in <span class="Variable">QUALNET_HOME</span>/include/dynamic.h:</div>
      <div class="Bulleted_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Bulleted_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="BulletSymbol">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Bulleted_inner"><a name="939896">ReadAsString: This function reads the value of the object with the given path. The function throws an exception if the path does not exist or if the path does not resolve to an object. that is readable.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Bulleted_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Bulleted_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="BulletSymbol">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Bulleted_inner"><a name="939909">WriteAsString: This function writes the value to the object with the given path. The function throws an exception if the path does not exist or if the path does not resolve to an object. that is writable.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Bulleted_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Bulleted_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="BulletSymbol">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Bulleted_inner"><a name="940688">ExecuteAsString: This function executes the object with the given path. The function throws an exception if the path does not exist or if the path does not resolve to an object. that is executable.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Bulleted_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Bulleted_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="BulletSymbol">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Bulleted_inner"><a name="939922">AddListener: This function adds a new listener to the object with the given path. The function throws an exception if the path does not resolve to an object. The function is defined only if listening is enabled. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Bulleted_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Bulleted_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="BulletSymbol">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Bulleted_inner"><a name="939929">RemoveListeners: This function removes all listeners from an object and frees their memory. The function is defined only if listening is enabled.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Body"><a name="940838">A typical external interface uses the dynamic API by calling functions ReadAsString, WriteAsString and ExecuteAsString. </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Chapter%207.18.3.html#939947', '');" title="Using the Dynamic API from an External Interface">Figure&nbsp;7-5</a></span> shows a sample code segment that makes a call to the function ReadAsString. In this example, the interface reads the value of <span style="font-family: &quot;Courier New&quot;">node/1/cbr/1024/numPktsSent</span> and prints the result. If the path is invalid or the object cannot be read, an exception is thrown, causing an error message to be printed.</div>
      <div class="Code_Segment"><a name="940819">&nbsp;</a></div>
      <div class="Code_Segment"><a name="940822">...</a></div>
      <div class="Code_Segment"><a name="940880">std::string value;</a></div>
      <div class="Code_Segment"><a name="939936">std::string errString;</a></div>
      <div class="Code_Segment"><a name="939937">try</a></div>
      <div class="Code_Segment"><a name="939938">{</a></div>
      <div class="Code_Segment"><a name="939939">    interface-&gt;partition-&gt;dynamicHierarchy.ReadAsString(</a></div>
      <div class="Code_Segment"><a name="940811">                                            “node/1/cbr/1024/numPktsSent”, value);</a></div>
      <div class="Code_Segment"><a name="939940">    printf(“The value is \”%s\”\n”, value.c str());</a></div>
      <div class="Code_Segment"><a name="939941">}</a></div>
      <div class="Code_Segment"><a name="939942">catch (D_Exception &amp;e)</a></div>
      <div class="Code_Segment"><a name="939943">{</a></div>
      <div class="Code_Segment"><a name="939944">    e.GetFullErrorString(errString);</a></div>
      <div class="Code_Segment"><a name="939945">    printf(“Error: \”%s\”\n”, errString.c str());</a></div>
      <div class="Code_Segment"><a name="939946">}</a></div>
      <div class="Code_Segment"><a name="940881">...</a></div>
      <div class="Figure">FIGURE 7-5.&nbsp;&nbsp;<a name="939947">Example Code to Use Function ReadAsString</a></div>
      <div class="Body"><a name="939950">Functions WriteAsString and ExecuteAsString work in a similar way.</a></div>
      <div class="Body"><a name="940938">If listening is enabled, the AddListener and RemoveListeners member functions of the </a><span style="font-family: &quot;Courier New&quot;">D_Hierarchy</span> class are also available. New <span style="font-family: &quot;Courier New&quot;">D_Listener</span> and <span style="font-family: &quot;Courier New&quot;">D_ListenerCallback</span> objects should be created for each listener that is added. <span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Chapter%207.18.3.html#940947', '');" title="Using the Dynamic API from an External Interface">Figure&nbsp;7-6</a></span> shows a sample code segment that makes a call to the function AddListener. In this example, a <span style="font-family: &quot;Courier New&quot;">ListenerCallback</span> class is defined. It overloads the () operator. In the second part of the code segment, a listener is added to the object <span style="font-family: &quot;Courier New&quot;">node/1/cbr/1024/numPktsSent</span>. The listener is <span style="font-family: &quot;Courier New&quot;">D_ListenerPercent</span>, which invokes the callback function whenever the variable changes by 10% compared to the last time the callback function was invoked. A sample string printed by the callback function is: “<span style="font-family: &quot;Courier New&quot;">The value of node/1/cbr/1024/numPktsSent changed to 350</span>”.</div>
      <div class="Code_Segment"><a name="939953">&nbsp;</a></div>
      <div class="Code_Segment"><a name="939954">...</a></div>
      <div class="Code_Segment"><a name="940885">class ListenerCallback : public D_ListenerCallback</a></div>
      <div class="Code_Segment"><a name="939955">{</a></div>
      <div class="Code_Segment"><a name="939956">    public:</a></div>
      <div class="Code_Segment"><a name="939957">        virtual void operator () (const std::string&amp; newValue)</a></div>
      <div class="Code_Segment"><a name="939958">        {</a></div>
      <div class="Code_Segment"><a name="939964">            printf("The variable changed to \”%s\”\n", newValue.c str());</a></div>
      <div class="Code_Segment"><a name="939965">        }</a></div>
      <div class="Code_Segment"><a name="939966">};</a></div>
      <div class="Code_Segment"><a name="939967">...</a></div>
      <div class="Code_Segment"><a name="939968">std::string errString;</a></div>
      <div class="Code_Segment"><a name="939969">try</a></div>
      <div class="Code_Segment"><a name="939970">{</a></div>
      <div class="Code_Segment"><a name="939971">    interface-&gt;partition-&gt;dynamicHierarchy.AddListener(</a></div>
      <div class="Code_Segment"><a name="939972">        “node/1/cbr/1024/numPktsSent”,       // path</a></div>
      <div class="Code_Segment"><a name="939973">        const std::string&amp; listenerType,</a></div>
      <div class="Code_Segment"><a name="943030">        “0.10”,                             // arguments</a></div>
      <div class="Code_Segment"><a name="943031">        “qsh”                               // listener tag</a></div>
      <div class="Code_Segment"><a name="943029">        new QshListenerCallback());</a></div>
      <div class="Code_Segment"><a name="939976">}</a></div>
      <div class="Code_Segment"><a name="939977">catch (D_Exception &amp;e)</a></div>
      <div class="Code_Segment"><a name="939978">{</a></div>
      <div class="Code_Segment"><a name="939979">    e.GetFullErrorString(errString);</a></div>
      <div class="Code_Segment"><a name="939980">    printf(“Error: \”%s\”\n”, errString.c str());</a></div>
      <div class="Code_Segment"><a name="939981">}</a></div>
      <div class="Figure">FIGURE 7-6.&nbsp;&nbsp;<a name="940947">Example Code to Use Function AddListener</a></div>
      <div class="Body"><a name="940922">The external interface may remove listeners by calling function RemoveListeners of </a><span style="font-family: &quot;Courier New&quot;">D_Hierarchy</span> class. <span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Chapter%207.18.3.html#940910', '');" title="Using the Dynamic API from an External Interface">Figure&nbsp;7-7</a></span> shows a sample code segment that makes a call to the function RemoveListeners. In this example, all listeners of the object <span style="font-family: &quot;Courier New&quot;">node/1/cbr/1024/numPktsSent</span> are removed.</div>
      <div class="Code_Segment"><a name="939987">&nbsp;</a></div>
      <div class="Code_Segment"><a name="939988">std::string errString;</a></div>
      <div class="Code_Segment"><a name="939989">try</a></div>
      <div class="Code_Segment"><a name="939990">{</a></div>
      <div class="Code_Segment"><a name="939991">    interface-&gt;partition-&gt;dynamicHierarchy.RemoveListeners(</a></div>
      <div class="Code_Segment"><a name="939992">        “node/1/cbr/1024/numPktsSent”,</a></div>
      <div class="Code_Segment"><a name="943046">        “qsh”);    // listener tag</a></div>
      <div class="Code_Segment"><a name="939993">}</a></div>
      <div class="Code_Segment"><a name="939994">catch (D_Exception &amp;e)</a></div>
      <div class="Code_Segment"><a name="939995">{</a></div>
      <div class="Code_Segment"><a name="939996">    e.GetFullErrorString(errString, “qsh”);</a></div>
      <div class="Code_Segment"><a name="939997">    printf(“Error: \”%s\”\n”, errString.c str ());</a></div>
      <div class="Code_Segment"><a name="939998">}</a></div>
      <div class="Figure">FIGURE 7-7.&nbsp;&nbsp;<a name="940910">Sample Code to Use Function RemoveListeners</a></div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="left">
      <tr>
        <td class="WebWorks_Company_Phone_Bottom">© 2008 - 2012 SCALABLE Network Technologies, Inc. All rights reserved.</td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>