<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>General Guidelines</title>
    <link rel="StyleSheet" href="css/Appendix%20B.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <div>
      <img src="snt-logo-text2-transparent-small.png" />
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="Appendix%20B.20.1.html#1004331">B	Coding Guidelines for Multi-Processor Platforms</a> &gt; B.1  General Guidelines</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading1Numbered">B.1  <a name="1004331">General Guidelines</a></div>
      <div class="BodyAfterHead"><a name="1002375">The following rules should be followed when developing parallel-safe models:</a></div>
      <div class="Numbered__0028first_0029_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered__0028first_0029_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered__0028first_0029_inner"><a name="1002464">Do not use global variables (see </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1002377', '');" title="General Guidelines">Section&nbsp;B.1.1</a></span>).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Numbered_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered_inner"><a name="1002376">Nodes should not access other nodes (see </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1002434', '');" title="General Guidelines">Section&nbsp;B.1.2</a></span>).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Numbered_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered_inner"><a name="1002474">Provide lookahead in MAC protocols (see </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1002852', '');" title="General Guidelines">Section&nbsp;B.1.3</a></span>).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Numbered_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered_inner"><a name="1002475">Do not violate inter-layer APIs (see </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003801', '');" title="General Guidelines">Section&nbsp;B.1.4</a></span>).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Heading2Numbered">B.1.1  <a name="1002377">Global Variables</a></div>
      <div class="Body" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 2.0pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0.0pt; margin-top: 0.0pt; text-align: justify; text-transform: none; vertical-align: baseline"><a name="1002509">&nbsp;</a></div>
      <div class="BodyAfterHead"><a name="1002510">Do not use static or global variables for the following reasons.</a></div>
      <div class="Numbered__0028first_0029_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered__0028first_0029_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered__0028first_0029_inner"><a name="1002511">Data in a parallel simulation must be accessed in time sequence, but since shared variables are outside the control of the simulation engine, time sequencing cannot be maintained even if the data is protected by mutex locks. (Independent of timing issues, locking of data via mutex locks or semaphores is slow and effectively makes the parallel processes sequential.)</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Numbered_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered_inner"><a name="1002512">It is usually safe to use global data that are written once (during initialization) and are subsequently read-only, provided that the initialization is properly sequenced and the same data made available to all processors. However, making the same data available to all processors may be non-trivial in a distributed environment.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Numbered_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Numbered_inner" style="width: 14.4pt; white-space: nowrap;">
                <span class="StepNumber">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Numbered_inner"><a name="1002562">Since real systems do not use shared data, protocol models that rely on shared data may not be accurate representation of the real system. Such models may provide inaccurate simulation results and should be avoided.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Body" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 2.0pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0.0pt; margin-top: 0.0pt; text-align: justify; text-transform: none; vertical-align: baseline"><a name="1002611">&nbsp;</a></div>
      <div class="Body"><a name="1002641">If your model depends on global state, make sure that the state is consistent on all partitions. If the state does not change after initialization (or is only used during initialization), try to have all partitions generate the same state deterministically. One way to achieve this is to use information contained in the configuration file.</a></div>
      <div class="Heading2Numbered">B.1.2  <a name="1002434">Accessing Other Nodes</a></div>
      <div class="BodyAfterHead"><a name="1002435">A node should not access another node’s data structure because the two nodes may be in different partitions. In particular, programmers may be tempted to have one node update another node’s statistics or applications. This should be avoided: statistics should be updated by the node to which the statistics belong. </a></div>
      <div class="Body"><a name="1002436">If, for some reason. a node is required to access another node’s data structure, then the code should check if the two nodes are in different partitions and take appropriate action if they are.</a></div>
      <div class="Body"><a name="1002791">Consider the code segment in </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1002821', '');" title="General Guidelines">Figure&nbsp;B-1</a></span>, which could be part of the function that initializes applications. This code segment checks if the originating node (with node identifier <span style="font-family: &quot;Courier New&quot;">sourceNodeId</span>) is on the local partition and aborts if it is not.</div>
      <div class="Code_Segment"><a name="1002794">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1002800">            ...</a></div>
      <div class="Code_Segment"><a name="1002881">            node = MAPPING_GetNodePtrFromHash(nodeHash, sourceNodeId)</a></div>
      <div class="Code_Segment"><a name="1002891">            if (node == NULL)</a></div>
      <div class="Code_Segment"><a name="1002801">            {</a></div>
      <div class="Code_Segment"><a name="1002803">               sprintf(errorString,</a></div>
      <div class="Code_Segment"><a name="1002804">                    "%s: Node %d does not exist",</a></div>
      <div class="Code_Segment"><a name="1002805">                    appInput.inputStrings[i],</a></div>
      <div class="Code_Segment"><a name="1002806">                    sourceNodeId);</a></div>
      <div class="Code_Segment"><a name="1002807">                ERROR_ReportError(errorString);</a></div>
      <div class="Code_Segment"><a name="1002808">            }</a></div>
      <div class="Code_Segment"><a name="1002882">            ...</a></div>
      <div class="Figure">FIGURE B-1.&nbsp;&nbsp;<a name="1002821">Handling Nodes in a Remote Partition: Incorrect Way</a></div>
      <div class="Body"><a name="1002825">However, it is more appropriate to not abort if the originating node is not in the local partition and to continue processing as long as the node exists in a remote partition. </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003006', '');" title="General Guidelines">Figure&nbsp;B-2</a></span> shows how this is done in function APP_InitializeApplications by using function PARTITION_NodeExists to check whether the node exists at all. If the node exists but is in another partition, then the function continues without taking any action. APP_InitializeApplications is implemented in /main/application.cpp. </div>
      <div class="Code_Segment"><a name="1002905">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1002977">void</a></div>
      <div class="Code_Segment"><a name="1002906">APP_InitializeApplications(</a></div>
      <div class="Code_Segment"><a name="1002907">    Node *firstNode,</a></div>
      <div class="Code_Segment"><a name="1002908">    const NodeInput *nodeInput)</a></div>
      <div class="Code_Segment"><a name="1002909">{</a></div>
      <div class="Code_Segment"><a name="1002849">  ...</a></div>
      <div class="Code_Segment"><a name="1002919">    if (firstNode == NULL)</a></div>
      <div class="Code_Segment"><a name="1002920">        return; // this partition has no nodes.</a></div>
      <div class="Code_Segment"><a name="1002921">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1002917">    nodeHash = firstNode-&gt;partitionData-&gt;nodeIdHash;</a></div>
      <div class="Code_Segment"><a name="1002925">    ...</a></div>
      <div class="Code_Segment"><a name="1002928">    for (i = 0; i &lt; appInput.numLines; i++)</a></div>
      <div class="Code_Segment"><a name="1002929">    {</a></div>
      <div class="Code_Segment"><a name="1002930">        sscanf(appInput.inputStrings[i], "%s", appStr);</a></div>
      <div class="Code_Segment"><a name="1002926">        ...</a></div>
      <div class="Code_Segment"><a name="1002941">        if (strcmp(appStr, "FTP") == 0)</a></div>
      <div class="Code_Segment"><a name="1002934">        {</a></div>
      <div class="Code_Segment"><a name="1002935">           ...</a></div>
      <div class="Code_Segment"><a name="1002981">        }</a></div>
      <div class="Code_Segment"><a name="1002946">        else if (strcmp(appStr, "GSM") == 0)</a></div>
      <div class="Code_Segment"><a name="1002936">        {</a></div>
      <div class="Code_Segment"><a name="1002950">            ...</a></div>
      <div class="Code_Segment"><a name="1002953">            // Call Originating(MO) node</a></div>
      <div class="Code_Segment"><a name="1002954">            if (PARTITION_NodeExists(firstNode-&gt;partitionData, sourceNodeId)</a></div>
      <div class="Code_Segment"><a name="1002955">                == FALSE)</a></div>
      <div class="Code_Segment"><a name="1002956">            {</a></div>
      <div class="Code_Segment"><a name="1002957">               sprintf(errorString,</a></div>
      <div class="Code_Segment"><a name="1002958">                    "%s: Node %d does not exist",</a></div>
      <div class="Code_Segment"><a name="1002959">                    appInput.inputStrings[i],</a></div>
      <div class="Code_Segment"><a name="1002960">                    sourceNodeId);</a></div>
      <div class="Code_Segment"><a name="1002961">                ERROR_ReportError(errorString);</a></div>
      <div class="Code_Segment"><a name="1002962">            }</a></div>
      <div class="Code_Segment"><a name="1002963">            node = MAPPING_GetNodePtrFromHash(nodeHash, sourceNodeId);</a></div>
      <div class="Code_Segment"><a name="1002964">            if (node == NULL)</a></div>
      <div class="Code_Segment"><a name="1002965">            {</a></div>
      <div class="Code_Segment"><a name="1002966">                // not on this partition</a></div>
      <div class="Code_Segment"><a name="1002967">                continue;</a></div>
      <div class="Code_Segment"><a name="1002951">            }</a></div>
      <div class="Code_Segment"><a name="1002937">            ...</a></div>
      <div class="Code_Segment"><a name="1002971">       }</a></div>
      <div class="Code_Segment"><a name="1002938">       ...</a></div>
      <div class="Code_Segment"><a name="1002985">     }</a></div>
      <div class="Code_Segment"><a name="1002986">     ...</a></div>
      <div class="Code_Segment"><a name="1002987">}</a></div>
      <div class="Figure">FIGURE B-2.&nbsp;&nbsp;<a name="1003006">Handling Nodes in a Remote Partition: Correct Way</a></div>
      <div class="Body"><a name="1003041">In </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003006', '');" title="General Guidelines">Figure&nbsp;B-2</a></span>, the fist parameter of function MAPPING_GetNodeFromHash is set to <span style="font-family: &quot;Courier New&quot;">firstNode-&gt;partitionData-&gt;nodeIdHash</span>. <span style="font-family: &quot;Courier New&quot;">firstNode-&gt;partitionData-&gt;nodeIdHash</span> contains pointers to nodes that are in this partition. </div>
      <div class="Body"><a name="1003120">The first parameter of function MAPPING_GetNodeFromHash can alternatively be set to </a><span style="font-family: &quot;Courier New&quot;">firstNode-&gt;partitionData-&gt;remoteNodeIdHash</span>. <span style="font-family: &quot;Courier New&quot;">firstNode-&gt;partitionData-&gt;remoteNodeIdHash</span> contains pointers to reference nodes which are shadow copies of nodes in other partitions. The reference nodes are used during MAC initialization to ensure that IP addresses are assigned properly. The user should never assume that the reference nodes contain any useful data.</div>
      <div class="Body"><a name="1003121">Instead of function MAPPING_GetNodePtrFromHash, function PARTITION_ReturnNodePointer can be used. PARTITION_ReturnNodePointer returns a pointer to the node if the node exists and returns NULL if it does not. To use this function, replace the following line in </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003006', '');" title="General Guidelines">Figure&nbsp;B-2</a></span>:</div>
      <div class="Declaration"><a name="1003090">&nbsp;</a></div>
      <div class="Declaration"><a name="1018118">node = MAPPING_GetNodePtrFromHash(nodeHash, sourceNodeId);</a></div>
      <div class="Body"><a name="1003088">with the following line:</a></div>
      <div class="Declaration"><a name="1003107">&nbsp;</a></div>
      <div class="Declaration"><a name="1018129">PARTITION_ReturnNodePointter(partitionData, &amp;node, sourceNodeId);</a></div>
      <div class="Heading2Numbered">B.1.3  <a name="1002852">MAC Lookahead</a></div>
      <div class="Body" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 2.0pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0.0pt; margin-top: 0.0pt; text-align: justify; text-transform: none; vertical-align: baseline"><a name="1003128">&nbsp;</a></div>
      <div class="BodyAfterHead"><a name="1003129"> uses a conservative parallel algorithm. To gain efficiency from parallel execution, protocols estimate a lookahead interval, which is a time interval during which nodes on different processors are guaranteed not to interfere with each other. The longer the lookahead interval, the better the parallel performance.</a></div>
      <div class="Body"><a name="1003166">Some MAC protocols, such as the IEEE 802.11 MAC, set a small lookahead based on the time it takes the physical radio device to change from receiving mode to transmitting mode.</a></div>
      <div class="Body"><a name="1003189">Some MAC protocols, such as the point-to-point link protocol, use the transmission delay as the lookahead. </a></div>
      <div class="Body"><a name="1003187">MAC protocols that are very predictable, such as the TDMA MAC protocol, can make good use of lookahead. TDMA protocols can predict the times of message transmissions exactly because transmissions occur in pre-assigned time slots. This exact time is called the earliest output time (EOT).</a></div>
      <div class="Body"><a name="1003219">A MAC protocol should either set a minimum lookahead for each interface or should indicate that it is not EOT-capable. The minimum lookahead is the smallest delay that is passed to function PHY_StartTransmittingSignal. For optimal performance, the minimum lookahead should be set to the largest possible value that the correct functioning of the protocol allows (which may be 0 in some cases).</a></div>
      <div class="Body"><a name="1003620">The lookahead functions that programmers can use are listed in </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003748', '');" title="General Guidelines">Table&nbsp;B-1</a></span>. The prototypes for these functions are contained in /include/parallel.h.</div>
      <table class="Format_A" style="text-align: left; width: 453.6pt" cellspacing="0" summary="">
        <caption>
          <div class="TableTitle">TABLE B-1.&nbsp;&nbsp;<a name="1003748">Lookahead Functions</a></div>
        </caption>
        <tr>
          <td style="background-color: #E6E6E6; border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: bottom; width: 252pt">
            <div class="CellHeading"><a name="1003752">Function</a></div>
          </td>
          <td style="background-color: #E6E6E6; border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: bottom; width: 201.6pt">
            <div class="CellHeading"><a name="1003754">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003756">PARALLEL_SetMinimumLookaheadForInterface</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003758">This function sets the minimum delay between messages going out on an interface. This is usually the minimum delay before transmission (ram-up delay) for wireless interfaces, or the transmission delay for wired interfaces.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003760">PARALLEL_SetProtocolIsNotEOTCapable</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003762">This function is used to indicate that the protocol is not capable of setting a specific EOT.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003768">PARALLEL_AddLookaheadHandleToLookaheadCalculator</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003770">This function adds a new lookahead handle to the lookahead calculator.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003781">PARALLEL_SetLookaheadHandleEOT</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #000000; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #000000; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 6pt; padding-right: 6pt; padding-top: 4pt; vertical-align: top">
            <div class="CellBody"><a name="1003783">This function updates the earliest output time.</a></div>
          </td>
        </tr>
      </table>
      <div class="Body"><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003222', '');" title="General Guidelines" name="1003220">Figure&nbsp;B-3</a></span> shows how the minimum lookahead is set in the IEEE 802.11 MAC protocol function MacDot11Init, which is implemented in /libraries/wireless/src/mac_dot11.cpp.</div>
      <div class="Code_Segment"><a name="1003227">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1017577">void MacDot11Init(</a></div>
      <div class="Code_Segment"><a name="1017578">    Node* node,</a></div>
      <div class="Code_Segment"><a name="1017579">    int interfaceIndex,</a></div>
      <div class="Code_Segment"><a name="1017580">    const NodeInput* nodeInput,</a></div>
      <div class="Code_Segment"><a name="1017581">    PhyModel phyModel,</a></div>
      <div class="Code_Segment"><a name="1017582">    SubnetMemberData* subnetList,</a></div>
      <div class="Code_Segment"><a name="1017583">    int nodesInSubnet,</a></div>
      <div class="Code_Segment"><a name="1017584">    int subnetListIndex,</a></div>
      <div class="Code_Segment"><a name="1017585">    NodeAddress subnetAddress,</a></div>
      <div class="Code_Segment"><a name="1017586">    int numHostBits,</a></div>
      <div class="Code_Segment"><a name="1017587">    BOOL isQosEnabled,</a></div>
      <div class="Code_Segment"><a name="1017588">    NetworkType networkType,</a></div>
      <div class="Code_Segment"><a name="1017589">    in6_addr *ipv6SubnetAddr,</a></div>
      <div class="Code_Segment"><a name="1003243">    unsigned int prefixLength)</a></div>
      <div class="Code_Segment"><a name="1017605">{</a></div>
      <div class="Code_Segment"><a name="1003221">    BOOL wasFound;</a></div>
      <div class="Code_Segment"><a name="1003247">    ...</a></div>
      <div class="Code_Segment"><a name="1017613">    MacDot11TraceInit(node, nodeInput, dot11);</a></div>
      <div class="Code_Segment"><a name="1017614">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1017615">#ifdef PARALLEL //Parallel</a></div>
      <div class="Code_Segment"><a name="1017616">    PARALLEL_SetProtocolIsNotEOTCapable(node);</a></div>
      <div class="Code_Segment"><a name="1017617">    PARALLEL_SetMinimumLookaheadForInterface(node,</a></div>
      <div class="Code_Segment"><a name="1017618">                                             dot11-&gt;delayUntilSignalAirborn);</a></div>
      <div class="Code_Segment"><a name="1003248">#endif //endParallel</a></div>
      <div class="Code_Segment"><a name="1017630">    ...</a></div>
      <div class="Code_Segment"><a name="1017637">}</a></div>
      <div class="Figure">FIGURE B-3.&nbsp;&nbsp;<a name="1003222">Setting Minimum Lookahead</a></div>
      <div class="Body"><a name="1003165">If your model’s behavior is very predictable, or if the earliest time at which your protocol will send a response changes during the protocol’s operation, you must allocate a lookahead handle and then repeatedly set the earliest output time.We show how this is done for the TDMA MAC protocol in </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003295', '');" title="General Guidelines">Figure&nbsp;B-4</a></span> and <span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003354', '');" title="General Guidelines">Figure&nbsp;B-5</a></span>. The lookahead handle is allocated in the function TDMA initialization function, MacTdmaInit, as shown in <span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003295', '');" title="General Guidelines">Figure&nbsp;B-4</a></span>. Every time function MacTdmaInitializeTimer is called, the earliest output time is updated, as shown in <span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Appendix%20B.20.2.html#1003354', '');" title="General Guidelines">Figure&nbsp;B-5</a></span>. Functions MacTdmaInit and MacTdmaInitializeTimer are implemented in /libraries/wireless/src/mac_tdma.cpp.</div>
      <div class="Code_Segment"><a name="1003267">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1003319">void MacTdmaInit(Node* node,</a></div>
      <div class="Code_Segment"><a name="1003320">                 int interfaceIndex,</a></div>
      <div class="Code_Segment"><a name="1003321">                 int interfaceAddress,</a></div>
      <div class="Code_Segment"><a name="1003322">                 const NodeInput* nodeInput,</a></div>
      <div class="Code_Segment"><a name="1003323">                 const int subnetListIndex,</a></div>
      <div class="Code_Segment"><a name="1003324">                 const int numNodesInSubnet)</a></div>
      <div class="Code_Segment"><a name="1003325">{</a></div>
      <div class="Code_Segment"><a name="1003303">    BOOL wasFound;</a></div>
      <div class="Code_Segment"><a name="1003305">   ...</a></div>
      <div class="Code_Segment"><a name="1003281">#ifdef PARALLEL //Parallel</a></div>
      <div class="Code_Segment"><a name="1003282">    tdma-&gt;lookaheadHandle = PARALLEL_AllocateLookaheadHandle (node);</a></div>
      <div class="Code_Segment"><a name="1003283">    PARALLEL_AddLookaheadHandleToLookaheadCalculator(</a></div>
      <div class="Code_Segment"><a name="1003284">        node, tdma-&gt;lookaheadHandle, 0);</a></div>
      <div class="Code_Segment"><a name="1003285">#endif //endParallel</a></div>
      <div class="Code_Segment"><a name="1003286">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1003287">    MacTdmaInitializeTimer(node, tdma);</a></div>
      <div class="Code_Segment"><a name="1003268">}</a></div>
      <div class="Figure">FIGURE B-4.&nbsp;&nbsp;<a name="1003295">Setting Lookahead Handle</a></div>
      <div class="Code_Segment"><a name="1003269">&nbsp;</a></div>
      <div class="Code_Segment"><a name="1003338">static</a></div>
      <div class="Code_Segment"><a name="1003339">void MacTdmaInitializeTimer(Node* node, MacDataTdma* tdma) {</a></div>
      <div class="Code_Segment"><a name="1003340">    int i;</a></div>
      <div class="Code_Segment"><a name="1003336">    ...</a></div>
      <div class="Code_Segment"><a name="1003356">    if (i == tdma-&gt;numSlotsPerFrame) {</a></div>
      <div class="Code_Segment"><a name="1003357">       ...</a></div>
      <div class="Code_Segment"><a name="1003369">      }</a></div>
      <div class="Code_Segment"><a name="1003374">    else {</a></div>
      <div class="Code_Segment"><a name="1003375">        Message *timerMsg;</a></div>
      <div class="Code_Segment"><a name="1003376">        clocktype delay;</a></div>
      <div class="Code_Segment"><a name="1003451">        delay = (tdma-&gt;slotDuration + tdma-&gt;guardTime) * i </a></div>
      <div class="Code_Segment"><a name="1003452">                 + tdma-&gt;interFrameTime;</a></div>
      <div class="Code_Segment"><a name="1003380">        ...</a></div>
      <div class="Code_Segment"><a name="1003393">#ifdef PARALLEL //Parallel</a></div>
      <div class="Code_Segment"><a name="1003394">        PARALLEL_SetLookaheadHandleEOT(node,</a></div>
      <div class="Code_Segment"><a name="1003395">            tdma-&gt;lookaheadHandle,</a></div>
      <div class="Code_Segment"><a name="1003396">            getSimTime(node) + delay + 5000);</a></div>
      <div class="Code_Segment"><a name="1003397">#endif //endParallel</a></div>
      <div class="Code_Segment"><a name="1003398">        ...</a></div>
      <div class="Code_Segment"><a name="1003410">    }</a></div>
      <div class="Code_Segment"><a name="1003353">}</a></div>
      <div class="Figure">FIGURE B-5.&nbsp;&nbsp;<a name="1003354">Setting Earliest Output Time</a></div>
      <div class="Heading2Numbered">B.1.4  <a name="1003801">Inter-Layer APIs</a></div>
      <div class="BodyAfterHead"><a name="1003802">Circumventing the inter-layer APIs (see </a><span class="Cross-Ref"><a href="javascript:WWHClickedPopup('Programmers_Guide', 'Chapter%204-11.html#948679', '');" title="Communication Between Layers">Section&nbsp;4.11</a></span>) violates the minimum lookahead settings. For this reason, do not violate protocol layer APIs by sending messages directly to other nodes. Use the protocol stack to send the message through the network.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="left">
      <tr>
        <td class="WebWorks_Company_Phone_Bottom">© 2008 - 2012 SCALABLE Network Technologies, Inc. All rights reserved.</td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>